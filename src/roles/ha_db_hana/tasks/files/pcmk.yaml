# Copyright (c) Microsoft Corporation.
# Licensed under the MIT License.

# Description: This file contains the expected configuration for the pacemaker cluster. The values
# are based on Microsoft's best practices and are subject to change based on the customer's requirements.

CRM_CONFIG_DEFAULTS:
  cluster-infrastructure:             corosync
  have-watchdog:                      'true'
  priority-fencing-delay:             '30'
  stonith-action:                     reboot
  stonith-enabled:                    'true'
  stonith-timeout:                    144s

OP_DEFAULTS:
  record-pending:                     'true'
  timeout:                            '600'

RSC_DEFAULTS:
  migration-threshold:                '5000'
  priority:                           '1'
  resource-stickiness:                '1000'

CONSTRAINTS:
  rsc_colocation:
    score:                            "4000"
    rsc-role:                         "Started"
    with-rsc-role:                    "Master"

  rsc_order:
    kind:                             "Optional"



VALID_CONFIGS:
  RHEL:
    '8.4': {}
    '9.0': {}
  SLES:
    '15.2': {}
    '15.3': {}

RESOURCE_DEFAULTS:
  stonith:
    instance_attributes:
      pcmk_delay_max:                   "30s"
      pcmk_monitor_retries:             "4"
      pcmk_action_limit:                "3"
      pcmk_reboot_timeout:              "900"
      power_timeout:                    "240"
    monitor:
      interval:                         "3600"
      timeout:                          "120"

  topology:
    meta_attributes:
      clone-node-max:                   "1"
      target-role:                      "Started"
      interleave:                       "true"
    operations:
      monitor:
        interval:                       "10"
        timeout:                        "600"
      start:
        interval:                       "0"
        timeout:                        "600"
      stop:
        interval:                       "0"
        timeout:                        "300"

  hana:
    meta_attributes:
      notify:                           "true"
      clone-max:                        "2"
      clone-node-max:                   "1"
      target-role:                      "Started"
      interleave:                       "true"
      priority:                         "100"
    instance_attributes:
      PREFER_SITE_TAKEOVER:             "true"
      DUPLICATE_PRIMARY_TIMEOUT:        "7200"
      AUTOMATED_REGISTER:               "true"
    operations:
      start:
        interval:                       "0"
        timeout:                        "3600"
      stop:
        interval:                       "0"
        timeout:                        "3600"
      promote:
        interval:                       "0"
        timeout:                        "3600"
      monitor:
        timeout:                        "700"

  ipaddr:
    meta_attributes:
      target-role:                      "Started"
    operations:
      monitor:
        interval:                       "10s"
        timeout:                        "20s"

  filesystem:
    meta_attributes:
      clone-node-max:                   "1"
      interleave:                       "true"
    operations:
      monitor:
        interval:                       "120"
        timeout:                        "120"
      start:
        interval:                       "0"
        timeout:                        "120"
      stop:
        interval:                       "0"
        timeout:                        "120"

OS_PARAMETERS:
  DEFAULTS:
    sysctl:
      net.ipv4.tcp_timestamps:          "net.ipv4.tcp_timestamps = 0"
      vm.swappiness:                    "vm.swappiness = 10"
    corosync-cmapctl:
      runtime.config.totem.token:       "runtime.config.totem.token (u32) = 30000"
      runtime.config.totem.consensus:   "runtime.config.totem.consensus (u32) = 36000"

GLOBAL_INI:
  SUSE:
    provider:                           "SAPHanaSR"
    path:                               "/usr/share/SAPHanaSR"
    execution_order:                    "1"

  REDHAT:
    provider:                           "SAPHanaSR"
    path:                               "/hana/shared/myHooks"
    execution_order:                    "1"


