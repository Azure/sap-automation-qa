# SAP HANA High Availability Test Cases

## Test Case Overview

| Test Case | Type | Task Name | Description |
|-----------|------|-----------|-------------|
| HA Parameters Validation | Configuration | [ha-config.yml](../../src/roles/ha_db_hana/tasks/ha-config.yml) | The HA parameter validation test validates HA configuration including Corosync settings, Pacemaker resources, SBD device configuration, and HANA system replication setup. |
| Azure Load Balancer | Configuration | [azure-lb.yml](../../src/roles/ha_db_hana/tasks/azure-lb.yml) |  The Azure LB configuration test validates Azure Load Balancer setup including health probe configuration, backend pool settings, load balancing rules, and frontend IP configuration. |
| Resource Migration | Failover | [resource-migration.yml](../../src/roles/ha_db_hana/tasks/resource-migration.yml) | The Resource Migration test validates planned failover scenarios by executing controlled resource movement between HANA nodes. It performs a graceful migration of the primary HANA resources to the secondary node, verifies proper role changes, ensures cluster maintains stability throughout the transition, and validates complete data synchronization after migration. |
| Primary Node Crash | Failover | [primary-node-crash.yml](../../src/roles/ha_db_hana/tasks/primary-node-crash.yml) | The Primary Index Server Crash test simulates cluster behavior when the HANA index server crashes on the primary node. It simulates an index server failure by forcefully terminating the process, then verifies automatic failover to the secondary node, monitors system replication status, and confirms service recovery without data loss. |
| Block Network | Network | [block-network.yml](../../src/roles/ha_db_hana/tasks/block-network.yml) | The Block Network test validates cluster behavior during network partition scenarios by implementing iptables rules to block communication between primary and secondary HANA nodes. It verifies split-brain prevention mechanisms, validates proper failover execution when nodes become isolated, and ensures cluster stability and data consistency after network connectivity is restored. |
| Primary Index Server Crash | Service | [primary-crash-index.yml](../../src/roles/ha_db_hana/tasks/primary-crash-index.yml) | The Primary Index Server Crash test validates high availability behavior by forcefully terminating the HANA index server process on the primary node. This simulates a critical service failure, triggering automatic failover to the secondary node. The test verifies proper failover execution, ensures data consistency, and validates service restoration after recovery. |
| Primary Node Kill | Process | [primary-node-kill.yml](../../src/roles/ha_db_hana/tasks/primary-node-kill.yml) | The Primary Node Kill test validates cluster behavior by forcefully terminating all HANA processes on the primary node using SIGKILL signal. This simulates an abrupt service failure, triggering automatic failover to the secondary node. The test verifies proper promotion of secondary to primary, ensures data consistency, and validates complete cluster recovery. |
| Primary Echo B | System | [primary-echo-b.yml](../../src/roles/ha_db_hana/tasks/primary-echo-b.yml) | The Primary Echo B test simulates an immediate system crash on the primary HANA node by executing the 'echo b' command to trigger an abrupt reboot without proper shutdown. This tests the cluster's ability to handle unexpected primary node failures, validates proper failover execution, and verifies data consistency after recovery. |
| Secondary Index Server Crash | Service | [secondary-crash-index.yml](../../src/roles/ha_db_hana/tasks/secondary-crash-index.yml) | The Secondary Index Server Crash test simulates failure of the HANA index server process on the secondary node. It validates that the primary node continues normal operation while verifying the cluster's ability to handle secondary failures, tests automatic recovery mechanisms, and ensures system replication resumes properly after service restoration. |
| Secondary Node Kill | Process | [secondary-node-kill.yml](../../src/roles/ha_db_hana/tasks/secondary-node-kill.yml) | The Secondary Node Kill test examines cluster resilience by forcefully terminating HANA processes on the secondary node using the kill -9 signal. The test validates that the primary node maintains normal operation while the secondary node undergoes recovery, ensuring cluster stability and proper data synchronization after the recovery process completes. |
| Secondary Echo B | System | [secondary-echo-b.yml](../../src/roles/ha_db_hana/tasks/secondary-echo-b.yml) | The Secondary Echo B test simulates an uncontrolled system crash on the secondary HANA node by executing the 'echo b' command, triggering an immediate reboot without proper shutdown procedures. The test validates that the primary node maintains operation, verifies cluster stability, and ensures system replication resumes correctly after the secondary node recovers. |
| Filesystem Freeze | Storage | [fs-freeze.yml](../../src/roles/ha_db_hana/tasks/fs-freeze.yml) | The Filesystem Freeze test validates cluster behavior when the primary node's filesystem becomes unresponsive. It simulates a storage issue by freezing the filesystem on the primary node running HANA database, which triggers automatic failover to the secondary node. The test verifies proper cluster reaction, resource migration, and data consistency after recovery. |
| SBD Fencing | Fencing | [sbd-fencing.yml](../../src/roles/ha_db_hana/tasks/sbd-fencing.yml) | Validates cluster fencing mechanism by killing the SBD inquisitor process on the primary node. Tests proper fence detection, node isolation, and automated failover to ensure cluster integrity during hardware or communication failures. |